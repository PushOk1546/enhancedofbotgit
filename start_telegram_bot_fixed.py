#!/usr/bin/env python3
"""
Ğ£Ğ»ÑƒÑ‡ÑˆĞµĞ½Ğ½Ñ‹Ğ¹ ÑÑ‚Ğ°Ñ€Ñ‚ĞµÑ€ Ğ´Ğ»Ñ Telegram Stars/TON Ğ±Ğ¾Ñ‚Ğ°
ĞĞ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¸ Ñ€ĞµÑˆĞ°ĞµÑ‚ Ğ¿Ñ€Ğ¾Ğ±Ğ»ĞµĞ¼Ñ‹ Ñ ĞºĞ¾Ğ½Ñ„Ğ»Ğ¸ĞºÑ‚Ğ°Ğ¼Ğ¸ API Ğ¸ Ğ´Ñ€ÑƒĞ³Ğ¸Ğµ Ñ€Ğ°ÑĞ¿Ñ€Ğ¾ÑÑ‚Ñ€Ğ°Ğ½ĞµĞ½Ğ½Ñ‹Ğµ Ğ¾ÑˆĞ¸Ğ±ĞºĞ¸
"""

import os
import sys
import time
import signal
from datetime import datetime

def print_startup_banner():
    """ĞšÑ€Ğ°ÑĞ¸Ğ²Ñ‹Ğ¹ Ğ±Ğ°Ğ½Ğ½ĞµÑ€ Ğ¿Ñ€Ğ¸ Ğ·Ğ°Ğ¿ÑƒÑĞºĞµ"""
    banner = """
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘            ğŸ”¥ TELEGRAM STARS & TON BOT v2.1 ğŸ”¥               â•‘
â•‘           ĞœĞ¾Ğ½ĞµÑ‚Ğ¸Ğ·Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ½Ñ‹Ğ¹ OF Ğ‘Ğ¾Ñ‚ (Ğ˜ÑĞ¿Ñ€Ğ°Ğ²Ğ»ĞµĞ½Ğ½Ñ‹Ğ¹)             â•‘
â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
â•‘  â­ Telegram Stars - Ğ¼Ğ³Ğ½Ğ¾Ğ²ĞµĞ½Ğ½Ğ°Ñ Ğ¾Ğ¿Ğ»Ğ°Ñ‚Ğ° Ğ² Ğ¿Ñ€Ğ¸Ğ»Ğ¾Ğ¶ĞµĞ½Ğ¸Ğ¸          â•‘
â•‘  ğŸ’ TON ĞšÑ€Ğ¸Ğ¿Ñ‚Ğ¾Ğ²Ğ°Ğ»ÑÑ‚Ğ° - Ğ´ĞµÑ†ĞµĞ½Ñ‚Ñ€Ğ°Ğ»Ğ¸Ğ·Ğ¾Ğ²Ğ°Ğ½Ğ½Ñ‹Ğµ Ğ¿Ğ»Ğ°Ñ‚ĞµĞ¶Ğ¸            â•‘
â•‘  ğŸ› ï¸ ĞĞ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¾Ğµ Ğ¸ÑĞ¿Ñ€Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ğµ API ĞºĞ¾Ğ½Ñ„Ğ»Ğ¸ĞºÑ‚Ğ¾Ğ²               â•‘
â•‘  ğŸ”§ Ğ£Ğ»ÑƒÑ‡ÑˆĞµĞ½Ğ½Ğ°Ñ Ğ¾Ğ±Ñ€Ğ°Ğ±Ğ¾Ñ‚ĞºĞ° Ğ¾ÑˆĞ¸Ğ±Ğ¾Ğº                             â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    """
    print(banner)
    print(f"ğŸ• Ğ—Ğ°Ğ¿ÑƒÑĞº: {datetime.now().strftime('%Y-%m-%d %H:%M:%S')}")
    print()

def check_environment():
    """ĞŸÑ€Ğ¾Ğ²ĞµÑ€ĞºĞ° Ğ¿ĞµÑ€ĞµĞ¼ĞµĞ½Ğ½Ñ‹Ñ… Ğ¾ĞºÑ€ÑƒĞ¶ĞµĞ½Ğ¸Ñ"""
    required_vars = {
        'BOT_TOKEN': 'Ğ¢Ğ¾ĞºĞµĞ½ Telegram Ğ±Ğ¾Ñ‚Ğ°',
        'TON_WALLET': 'TON ĞºĞ¾ÑˆĞµĞ»ĞµĞº Ğ´Ğ»Ñ Ğ¿Ñ€Ğ¸ĞµĞ¼Ğ° Ğ¿Ğ»Ğ°Ñ‚ĞµĞ¶ĞµĞ¹ (Ğ¾Ğ¿Ñ†Ğ¸Ğ¾Ğ½Ğ°Ğ»ÑŒĞ½Ğ¾)',
        'ADMIN_USER_IDS': 'ID Ğ°Ğ´Ğ¼Ğ¸Ğ½Ğ¸ÑÑ‚Ñ€Ğ°Ñ‚Ğ¾Ñ€Ğ¾Ğ² (Ğ¾Ğ¿Ñ†Ğ¸Ğ¾Ğ½Ğ°Ğ»ÑŒĞ½Ğ¾)'
    }
    
    missing_vars = []
    
    for var, description in required_vars.items():
        value = os.getenv(var)
        if not value and var == 'BOT_TOKEN':
            missing_vars.append(f"âŒ {var}: {description}")
        elif value:
            if var == 'BOT_TOKEN':
                print(f"âœ… {var}: {'*' * (len(value)-8) + value[-8:]}")
            else:
                print(f"âœ… {var}: {value}")
        else:
            print(f"âš ï¸  {var}: Ğ½Ğµ ÑƒÑÑ‚Ğ°Ğ½Ğ¾Ğ²Ğ»ĞµĞ½ (Ğ±ÑƒĞ´ĞµÑ‚ Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ÑŒÑÑ Ğ·Ğ½Ğ°Ñ‡ĞµĞ½Ğ¸Ğµ Ğ¿Ğ¾ ÑƒĞ¼Ğ¾Ğ»Ñ‡Ğ°Ğ½Ğ¸Ñ)")
    
    if missing_vars:
        print("\nğŸš¨ ĞšĞ Ğ˜Ğ¢Ğ˜Ğ§Ğ•Ğ¡ĞšĞ˜Ğ• ĞĞ¨Ğ˜Ğ‘ĞšĞ˜:")
        for error in missing_vars:
            print(error)
        return False
    
    return True

def kill_existing_bots():
    """ĞÑÑ‚Ğ°Ğ½Ğ¾Ğ²Ğ¸Ñ‚ÑŒ ÑÑƒÑ‰ĞµÑÑ‚Ğ²ÑƒÑÑ‰Ğ¸Ğµ Ğ¿Ñ€Ğ¾Ñ†ĞµÑÑÑ‹ Ğ±Ğ¾Ñ‚Ğ¾Ğ²"""
    print("ğŸ” ĞŸĞ¾Ğ¸ÑĞº ÑÑƒÑ‰ĞµÑÑ‚Ğ²ÑƒÑÑ‰Ğ¸Ñ… Ğ¿Ñ€Ğ¾Ñ†ĞµÑÑĞ¾Ğ² Ğ±Ğ¾Ñ‚Ğ¾Ğ²...")
    
    try:
        import psutil
        
        current_pid = os.getpid()
        killed_processes = []
        
        for proc in psutil.process_iter(['pid', 'name', 'cmdline']):
            try:
                # ĞŸÑ€Ğ¾Ğ²ĞµÑ€ÑĞµĞ¼ Python Ğ¿Ñ€Ğ¾Ñ†ĞµÑÑÑ‹ Ñ Ğ½Ğ°ÑˆĞ¸Ğ¼Ğ¸ ÑĞºÑ€Ğ¸Ğ¿Ñ‚Ğ°Ğ¼Ğ¸
                if proc.info['name'] and 'python' in proc.info['name'].lower():
                    cmdline = proc.info['cmdline']
                    if cmdline and any('bot' in arg.lower() for arg in cmdline):
                        if proc.info['pid'] != current_pid:  # ĞĞµ ÑƒĞ±Ğ¸Ğ²Ğ°ĞµĞ¼ Ñ‚ĞµĞºÑƒÑ‰Ğ¸Ğ¹ Ğ¿Ñ€Ğ¾Ñ†ĞµÑÑ
                            print(f"ğŸ”ª ĞÑÑ‚Ğ°Ğ½Ğ¾Ğ²ĞºĞ° Ğ¿Ñ€Ğ¾Ñ†ĞµÑÑĞ°: PID {proc.info['pid']}")
                            proc.terminate()
                            killed_processes.append(proc.info['pid'])
            except (psutil.NoSuchProcess, psutil.AccessDenied):
                continue
        
        if killed_processes:
            print(f"âœ… ĞÑÑ‚Ğ°Ğ½Ğ¾Ğ²Ğ»ĞµĞ½Ğ¾ {len(killed_processes)} Ğ¿Ñ€Ğ¾Ñ†ĞµÑÑĞ¾Ğ²")
            time.sleep(2)  # Ğ”Ğ°Ñ‚ÑŒ Ğ²Ñ€ĞµĞ¼Ñ Ğ½Ğ° Ğ·Ğ°Ğ²ĞµÑ€ÑˆĞµĞ½Ğ¸Ğµ
        else:
            print("â„¹ï¸ ĞšĞ¾Ğ½Ñ„Ğ»Ğ¸ĞºÑ‚ÑƒÑÑ‰Ğ¸Ğµ Ğ¿Ñ€Ğ¾Ñ†ĞµÑÑÑ‹ Ğ½Ğµ Ğ½Ğ°Ğ¹Ğ´ĞµĞ½Ñ‹")
            
    except ImportError:
        print("âš ï¸ psutil Ğ½Ğµ ÑƒÑÑ‚Ğ°Ğ½Ğ¾Ğ²Ğ»ĞµĞ½, Ğ¿Ñ€Ğ¾Ğ¿ÑƒÑĞºĞ°ĞµĞ¼ Ğ¿Ñ€Ğ¾Ğ²ĞµÑ€ĞºÑƒ Ğ¿Ñ€Ğ¾Ñ†ĞµÑÑĞ¾Ğ²")

def setup_signal_handlers():
    """ĞĞ°ÑÑ‚Ñ€Ğ¾Ğ¹ĞºĞ° Ğ¾Ğ±Ñ€Ğ°Ğ±Ğ¾Ñ‚Ñ‡Ğ¸ĞºĞ¾Ğ² ÑĞ¸Ğ³Ğ½Ğ°Ğ»Ğ¾Ğ² Ğ´Ğ»Ñ ĞºĞ¾Ñ€Ñ€ĞµĞºÑ‚Ğ½Ğ¾Ğ³Ğ¾ Ğ·Ğ°Ğ²ĞµÑ€ÑˆĞµĞ½Ğ¸Ñ"""
    def signal_handler(sig, frame):
        print("\n\nâ¹ï¸ ĞŸĞ¾Ğ»ÑƒÑ‡ĞµĞ½ ÑĞ¸Ğ³Ğ½Ğ°Ğ» Ğ·Ğ°Ğ²ĞµÑ€ÑˆĞµĞ½Ğ¸Ñ...")
        print("ğŸ”„ ĞšĞ¾Ñ€Ñ€ĞµĞºÑ‚Ğ½Ğ¾Ğµ Ğ·Ğ°Ğ²ĞµÑ€ÑˆĞµĞ½Ğ¸Ğµ Ğ±Ğ¾Ñ‚Ğ°...")
        sys.exit(0)
    
    signal.signal(signal.SIGINT, signal_handler)
    if hasattr(signal, 'SIGTERM'):
        signal.signal(signal.SIGTERM, signal_handler)

def create_fixed_bot():
    """Ğ¡Ğ¾Ğ·Ğ´Ğ°Ñ‚ÑŒ Ğ±Ğ¾Ñ‚Ğ° Ñ Ğ¸ÑĞ¿Ñ€Ğ°Ğ²Ğ»ĞµĞ½Ğ¸ÑĞ¼Ğ¸ ĞºĞ¾Ğ½Ñ„Ğ»Ğ¸ĞºÑ‚Ğ¾Ğ² API"""
    try:
        from monetized_bot import MonetizedBot
        import telebot
        
        # Ğ¡Ğ¾Ğ·Ğ´Ğ°ĞµĞ¼ Ğ±Ğ¾Ñ‚Ğ° Ñ ÑƒĞ»ÑƒÑ‡ÑˆĞµĞ½Ğ½Ğ¾Ğ¹ Ğ¾Ğ±Ñ€Ğ°Ğ±Ğ¾Ñ‚ĞºĞ¾Ğ¹ Ğ¾ÑˆĞ¸Ğ±Ğ¾Ğº
        class FixedMonetizedBot(MonetizedBot):
            def __init__(self):
                super().__init__()
                self.max_retries = 3
                self.retry_delay = 5
            
            def run_with_error_handling(self):
                """Ğ—Ğ°Ğ¿ÑƒÑĞº Ñ Ğ¾Ğ±Ñ€Ğ°Ğ±Ğ¾Ñ‚ĞºĞ¾Ğ¹ Ğ¾ÑˆĞ¸Ğ±Ğ¾Ğº API"""
                for attempt in range(self.max_retries):
                    try:
                        print(f"ğŸš€ ĞŸĞ¾Ğ¿Ñ‹Ñ‚ĞºĞ° Ğ·Ğ°Ğ¿ÑƒÑĞºĞ° #{attempt + 1}...")
                        
                        # ĞÑ‡Ğ¸ÑÑ‚ĞºĞ° webhook Ğ¿ĞµÑ€ĞµĞ´ Ğ·Ğ°Ğ¿ÑƒÑĞºĞ¾Ğ¼ polling
                        try:
                            self.bot.remove_webhook()
                            print("âœ… Webhook Ğ¾Ñ‡Ğ¸Ñ‰ĞµĞ½")
                            time.sleep(1)
                        except Exception as e:
                            print(f"âš ï¸ ĞĞµ ÑƒĞ´Ğ°Ğ»Ğ¾ÑÑŒ Ğ¾Ñ‡Ğ¸ÑÑ‚Ğ¸Ñ‚ÑŒ webhook: {e}")
                        
                        # Ğ¢ĞµÑÑ‚ Ğ¿Ğ¾Ğ´ĞºĞ»ÑÑ‡ĞµĞ½Ğ¸Ñ Ğº API
                        try:
                            me = self.bot.get_me()
                            print(f"âœ… ĞŸĞ¾Ğ´ĞºĞ»ÑÑ‡ĞµĞ½Ğ¸Ğµ Ğº API ÑƒÑĞ¿ĞµÑˆĞ½Ğ¾: @{me.username}")
                        except Exception as e:
                            print(f"âŒ ĞÑˆĞ¸Ğ±ĞºĞ° Ğ¿Ğ¾Ğ´ĞºĞ»ÑÑ‡ĞµĞ½Ğ¸Ñ Ğº API: {e}")
                            if attempt < self.max_retries - 1:
                                print(f"â³ ĞŸĞ¾Ğ²Ñ‚Ğ¾Ñ€ Ñ‡ĞµÑ€ĞµĞ· {self.retry_delay} ÑĞµĞºÑƒĞ½Ğ´...")
                                time.sleep(self.retry_delay)
                                continue
                            else:
                                raise
                        
                        # Ğ—Ğ°Ğ¿ÑƒÑĞº polling Ñ Ğ¿Ğ¾Ğ²Ñ‚Ğ¾Ñ€Ğ½Ñ‹Ğ¼Ğ¸ Ğ¿Ğ¾Ğ¿Ñ‹Ñ‚ĞºĞ°Ğ¼Ğ¸
                        print("ğŸ”„ Ğ—Ğ°Ğ¿ÑƒÑĞº polling...")
                        self.bot.polling(
                            none_stop=True,
                            timeout=60,
                            long_polling_timeout=60,
                            interval=1
                        )
                        
                    except telebot.apihelper.ApiTelegramException as e:
                        if "409" in str(e) or "Conflict" in str(e):
                            print(f"âš ï¸ ĞšĞ¾Ğ½Ñ„Ğ»Ğ¸ĞºÑ‚ API (409) - Ğ¿Ğ¾Ğ¿Ñ‹Ñ‚ĞºĞ° {attempt + 1}")
                            if attempt < self.max_retries - 1:
                                print(f"â³ ĞĞ¶Ğ¸Ğ´Ğ°Ğ½Ğ¸Ğµ {self.retry_delay * (attempt + 1)} ÑĞµĞºÑƒĞ½Ğ´...")
                                time.sleep(self.retry_delay * (attempt + 1))
                                continue
                            else:
                                print("âŒ ĞĞµ ÑƒĞ´Ğ°Ğ»Ğ¾ÑÑŒ Ñ€Ğ°Ğ·Ñ€ĞµÑˆĞ¸Ñ‚ÑŒ ĞºĞ¾Ğ½Ñ„Ğ»Ğ¸ĞºÑ‚ API Ğ¿Ğ¾ÑĞ»Ğµ Ğ²ÑĞµÑ… Ğ¿Ğ¾Ğ¿Ñ‹Ñ‚Ğ¾Ğº")
                                raise
                        else:
                            print(f"âŒ ĞÑˆĞ¸Ğ±ĞºĞ° Telegram API: {e}")
                            raise
                    
                    except KeyboardInterrupt:
                        print("\nâ¹ï¸ ĞÑÑ‚Ğ°Ğ½Ğ¾Ğ²ĞºĞ° Ğ¿Ğ¾ Ğ·Ğ°Ğ¿Ñ€Ğ¾ÑÑƒ Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»Ñ")
                        break
                    
                    except Exception as e:
                        print(f"âŒ ĞĞµĞ¾Ğ¶Ğ¸Ğ´Ğ°Ğ½Ğ½Ğ°Ñ Ğ¾ÑˆĞ¸Ğ±ĞºĞ°: {e}")
                        if attempt < self.max_retries - 1:
                            print(f"â³ ĞŸĞ¾Ğ²Ñ‚Ğ¾Ñ€ Ñ‡ĞµÑ€ĞµĞ· {self.retry_delay} ÑĞµĞºÑƒĞ½Ğ´...")
                            time.sleep(self.retry_delay)
                            continue
                        else:
                            raise
                    
                    # Ğ•ÑĞ»Ğ¸ Ğ´Ğ¾ÑˆĞ»Ğ¸ ÑÑĞ´Ğ° - ÑƒÑĞ¿ĞµÑˆĞ½Ñ‹Ğ¹ Ğ·Ğ°Ğ¿ÑƒÑĞº
                    break
        
        return FixedMonetizedBot()
        
    except ImportError as e:
        print(f"âŒ ĞÑˆĞ¸Ğ±ĞºĞ° Ğ¸Ğ¼Ğ¿Ğ¾Ñ€Ñ‚Ğ°: {e}")
        return None

def main():
    """Ğ“Ğ»Ğ°Ğ²Ğ½Ğ°Ñ Ñ„ÑƒĞ½ĞºÑ†Ğ¸Ñ Ğ·Ğ°Ğ¿ÑƒÑĞºĞ°"""
    # ĞšÑ€Ğ°ÑĞ¸Ğ²Ñ‹Ğ¹ Ğ±Ğ°Ğ½Ğ½ĞµÑ€
    print_startup_banner()
    
    # ĞĞ°ÑÑ‚Ñ€Ğ¾Ğ¹ĞºĞ° Ğ¾Ğ±Ñ€Ğ°Ğ±Ğ¾Ñ‚Ñ‡Ğ¸ĞºĞ¾Ğ² ÑĞ¸Ğ³Ğ½Ğ°Ğ»Ğ¾Ğ²
    setup_signal_handlers()
    
    # ĞÑÑ‚Ğ°Ğ½Ğ¾Ğ²ĞºĞ° ÑÑƒÑ‰ĞµÑÑ‚Ğ²ÑƒÑÑ‰Ğ¸Ñ… Ğ±Ğ¾Ñ‚Ğ¾Ğ²
    kill_existing_bots()
    
    # ĞŸÑ€Ğ¾Ğ²ĞµÑ€ĞºĞ° Ğ¾ĞºÑ€ÑƒĞ¶ĞµĞ½Ğ¸Ñ
    print("ğŸŒ ĞŸĞ ĞĞ’Ğ•Ğ ĞšĞ ĞŸĞ•Ğ Ğ•ĞœĞ•ĞĞĞ«Ğ¥ ĞĞšĞ Ğ£Ğ–Ğ•ĞĞ˜Ğ¯:")
    print("-" * 40)
    if not check_environment():
        print("\nğŸš¨ ĞĞ°ÑÑ‚Ñ€Ğ¾Ğ¹Ñ‚Ğµ Ğ¿ĞµÑ€ĞµĞ¼ĞµĞ½Ğ½Ñ‹Ğµ Ğ¾ĞºÑ€ÑƒĞ¶ĞµĞ½Ğ¸Ñ:")
        print("set BOT_TOKEN=Ğ²Ğ°Ñˆ_Ñ‚Ğ¾ĞºĞµĞ½")
        print("set ADMIN_USER_IDS=377917978")
        sys.exit(1)
    
    print("\nğŸš€ Ğ—ĞĞŸĞ£Ğ¡Ğš Ğ‘ĞĞ¢Ğ Ğ¡ Ğ˜Ğ¡ĞŸĞ ĞĞ’Ğ›Ğ•ĞĞ˜Ğ¯ĞœĞ˜...")
    print("=" * 50)
    
    try:
        # Ğ¡Ğ¾Ğ·Ğ´Ğ°Ğ½Ğ¸Ğµ Ğ¸ Ğ·Ğ°Ğ¿ÑƒÑĞº Ğ±Ğ¾Ñ‚Ğ°
        bot = create_fixed_bot()
        if not bot:
            print("âŒ ĞĞµ ÑƒĞ´Ğ°Ğ»Ğ¾ÑÑŒ ÑĞ¾Ğ·Ğ´Ğ°Ñ‚ÑŒ Ğ±Ğ¾Ñ‚Ğ°")
            sys.exit(1)
        
        print("âœ… Ğ‘Ğ¾Ñ‚ ÑĞ¾Ğ·Ğ´Ğ°Ğ½ ÑƒÑĞ¿ĞµÑˆĞ½Ğ¾")
        print("â­ Telegram Stars ÑĞ¸ÑÑ‚ĞµĞ¼Ğ°: ĞĞšĞ¢Ğ˜Ğ’ĞĞ")
        print("ğŸ’ TON Ğ¿Ğ»Ğ°Ñ‚ĞµĞ¶Ğ¸: ĞĞšĞ¢Ğ˜Ğ’ĞĞ«") 
        print("ğŸ” Ğ­ĞºÑĞ¿Ğ»Ğ¸Ñ†Ğ¸Ñ‚Ğ½Ñ‹Ğ¹ ĞºĞ¾Ğ½Ñ‚ĞµĞ½Ñ‚: Ğ—ĞĞ“Ğ Ğ£Ğ–Ğ•Ğ")
        print("ğŸ’¾ ĞšĞµÑˆĞ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ: ĞĞŸĞ¢Ğ˜ĞœĞ˜Ğ—Ğ˜Ğ ĞĞ’ĞĞĞ")
        print("ğŸ› ï¸ ĞĞ±Ñ€Ğ°Ğ±Ğ¾Ñ‚ĞºĞ° Ğ¾ÑˆĞ¸Ğ±Ğ¾Ğº: Ğ£Ğ›Ğ£Ğ§Ğ¨Ğ•ĞĞ")
        print()
        print("ğŸ”¥ Ğ‘Ğ¾Ñ‚ Ğ·Ğ°Ğ¿ÑƒÑ‰ĞµĞ½! ĞĞ°Ğ¶Ğ¼Ğ¸Ñ‚Ğµ Ctrl+C Ğ´Ğ»Ñ Ğ¾ÑÑ‚Ğ°Ğ½Ğ¾Ğ²ĞºĞ¸")
        print("ğŸ“± ĞĞ°Ñ‡Ğ½Ğ¸Ñ‚Ğµ Ñ‡Ğ°Ñ‚ Ñ Ğ±Ğ¾Ñ‚Ğ¾Ğ¼ Ğ² Telegram")
        print()
        
        # Ğ—Ğ°Ğ¿ÑƒÑĞº Ñ Ğ¾Ğ±Ñ€Ğ°Ğ±Ğ¾Ñ‚ĞºĞ¾Ğ¹ Ğ¾ÑˆĞ¸Ğ±Ğ¾Ğº
        bot.run_with_error_handling()
        
    except KeyboardInterrupt:
        print("\n\nâ¹ï¸ Ğ‘Ğ¾Ñ‚ Ğ¾ÑÑ‚Ğ°Ğ½Ğ¾Ğ²Ğ»ĞµĞ½ Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»ĞµĞ¼")
        sys.exit(0)
    except Exception as e:
        print(f"\n\nğŸš¨ ĞšĞ Ğ˜Ğ¢Ğ˜Ğ§Ğ•Ğ¡ĞšĞĞ¯ ĞĞ¨Ğ˜Ğ‘ĞšĞ: {e}")
        print("ğŸ“ ĞŸĞ¾Ğ¿Ñ€Ğ¾Ğ±ÑƒĞ¹Ñ‚Ğµ:")
        print("1. ĞŸĞ¾Ğ´Ğ¾Ğ¶Ğ´Ğ°Ñ‚ÑŒ 30 ÑĞµĞºÑƒĞ½Ğ´ Ğ¸ Ğ·Ğ°Ğ¿ÑƒÑÑ‚Ğ¸Ñ‚ÑŒ ÑĞ½Ğ¾Ğ²Ğ°")
        print("2. ĞŸÑ€Ğ¾Ğ²ĞµÑ€Ğ¸Ñ‚ÑŒ Ñ‚Ğ¾ĞºĞµĞ½ Ğ±Ğ¾Ñ‚Ğ°")
        print("3. Ğ£Ğ±ĞµĞ´Ğ¸Ñ‚ÑŒÑÑ, Ñ‡Ñ‚Ğ¾ Ğ½ĞµÑ‚ Ğ´Ñ€ÑƒĞ³Ğ¸Ñ… Ğ·Ğ°Ğ¿ÑƒÑ‰ĞµĞ½Ğ½Ñ‹Ñ… Ğ±Ğ¾Ñ‚Ğ¾Ğ²")
        sys.exit(1)

if __name__ == "__main__":
    main() 